print(model)
ggplot(model)
ggplot(model)
# Print the AOR table
kable(aor_table,digits = 2)
# Print the AOR table
kable(aor_table,digits = 5)
# Print the AOR table
kable(aor_table,digits = 4)
# Print the AOR table
kable(aor_table,digits = 3)
# Print the AOR table
kable(aor_table,digits = 2)
#convert it to a factor class
unique(data2$PriorPretermBirth)
glimpse(df_clean_long)
df_clean_long
Fig1c
################################################################################
# Figure 1c - bar chart with individual microplastics comparisons
count_tab_log1p
library(ggpubr)
ggscatter(data = count_tab_log1p,x = "Gestational_Age",y = "CumulativeMNPs",cor.coef = T)
count_tab
count_tab_log1p
data
df
library(ggpubr)
library(ggsci)
library(tidyverse)
library(mosaic)
################################################################################
count_tab_log1p$Maternal.smoking_Never
################################################################################
count_tab_log1p$Maternal.smoking_Never
################################################################################
class(count_tab_log1p$Maternal.smoking_Never)
################################################################################
count_tab_log1p<-count_tab_log1p%>%mutate(Maternal.smoking_Never=factor(Maternal.smoking_Never))
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",add = "jitter"
)
my_comparisons<-list(c("0","1"))
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",add = "jitter"
)+stat_compare_means(comparisons = my_comparisons)
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "t")
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "kr")
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "kruskal.test")
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
################################################################################
count_tab_log1p<-count_tab_log1p%>%
mutate(Maternal.smoking_Never=factor(Maternal.smoking_Never),
Gestational.diabetes_Yes=factor(Gestational.diabetes_Yes),
Preeclampsia_Yes=factor(Preeclampsia_Yes))
my_comparisons<-list(c("0","1"))
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Gestational.diabetes_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Preeclampsia_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Preeclampsia_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "t")
ggboxplot(data = count_tab_log1p,
x = "Preeclampsia_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Gestational.diabetes_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
count_tab_log1p
data
df
library(ggpubr)
library(ggsci)
library(tidyverse)
library(mosaic)
################################################################################
count_tab_log1p<-count_tab_log1p%>%
mutate(Maternal.smoking_Never=factor(Maternal.smoking_Never),
Gestational.diabetes_Yes=factor(Gestational.diabetes_Yes),
Preeclampsia_Yes=factor(Preeclampsia_Yes))
my_comparisons<-list(c("0","1"))
ggboxplot(data = count_tab_log1p,
x = "Maternal.smoking_Never",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Gestational.diabetes_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggboxplot(data = count_tab_log1p,
x = "Preeclampsia_Yes",
y = "CumulativeMNPs",
add = "jitter")+
stat_compare_means(comparisons = my_comparisons,method = "wilcox")
ggscatter(data = count_tab_log1p,
x = "Gestational_Age",
y = "CumulativeMNPs",
cor.coef = T)+scale_color_viridis_c(option = "B")
ggscatter(data = count_tab_log1p,
x = "Gestational_Age",
y = "CumulativeMNPs",add = "reg.line",
cor.coef = T)+scale_color_viridis_c(option = "B")
y = CumulativeMNPs,colour =CumulativeMNPs)
colour =CumulativeMNPs)+geom_point()+geom_smooth()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+geom_point()+geom_smooth()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
geom_smooth(method = "lm")
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
geom_smooth(method = "lm")+theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_compare_means()+
geom_smooth(method = "lm")+theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
geom_smooth(method = "lm")+theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B"+)
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
ylab(label = "log1p Cumulative MNPs (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
ylab(label = " Cumulative MNPs log1p(μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
ylab(label = " Cumulative MNPs (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr()
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
ylab(label = " Cumulative MNPs (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
stat_cor()+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
ggtitle(label = "Cumulative MNPs")+
stat_cor()+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
ggtitle(label = "Cumulative MNPs")+
stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = count_tab_log1p,
mapping = aes(x = Gestational_Age,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
ggplot(data = count_tab_log1p,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
library(ggpubr)
library(ggsci)
library(tidyverse)
library(mosaic)
################################################################################
ggplot(data = count_tab_log1p,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
ggplot(data = count_tab_log1p,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
# stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
ggplot(data = count_tab_log1p,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
ggplot(data = count_tab,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
count_tab
################################################################################
df
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = CumulativeMNPs,
colour =CumulativeMNPs))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
################################################################################
range(df$PC)
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df%>%filter(PC<20),
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df%>%filter(PC<20),
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "spearman",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC,
colour =PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
df
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+
# yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df%>%filter(PC<20),
mapping = aes(x = Birth.weight,
y = PC))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+
# yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df%>%filter(PC<20),
mapping = aes(x = Birth.weight,
y = PU))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+
# yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
ggplot(data = df,
mapping = aes(x = Birth.weight,
y = PU))+
geom_point()+
# ggtitle(label = "Cumulative MNPs (log1p)")+
stat_cor(method = "pearson",label.y.npc = "bottom")+
ylab(label = " Concentration (μg/g)")+
# yscale("log10")+
geom_smooth(method = "lm")+
scale_color_viridis_c(option = "B")+
theme_pubr(legend = "right")
